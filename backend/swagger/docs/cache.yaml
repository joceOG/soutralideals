# üíæ DOCUMENTATION SWAGGER - CACHE & OPTIMISATIONS

paths:
  /cache/stats:
    get:
      tags:
        - Cache
      summary: "üìä Statistiques du cache"
      description: "R√©cup√©rer les statistiques d√©taill√©es du syst√®me de cache"
      security:
        - bearerAuth: []
      responses:
        200:
          description: "Statistiques du cache r√©cup√©r√©es avec succ√®s"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      cacheType:
                        type: string
                        description: "Type de cache utilis√©"
                        example: "simple"
                      totalKeys:
                        type: integer
                        description: "Nombre total de cl√©s en cache"
                        example: 1250
                      memoryUsage:
                        type: object
                        properties:
                          used:
                            type: string
                            description: "M√©moire utilis√©e"
                            example: "45.2 MB"
                          total:
                            type: string
                            description: "M√©moire totale"
                            example: "128.0 MB"
                          percentage:
                            type: number
                            description: "Pourcentage d'utilisation"
                            example: 35.3
                      hitRate:
                        type: number
                        description: "Taux de r√©ussite du cache (0-100)"
                        example: 87.5
                      missRate:
                        type: number
                        description: "Taux d'√©chec du cache (0-100)"
                        example: 12.5
                      topKeys:
                        type: array
                        description: "Cl√©s les plus utilis√©es"
                        items:
                          type: object
                          properties:
                            key:
                              type: string
                              example: "user:12345"
                            hits:
                              type: integer
                              example: 150
                            lastAccessed:
                              type: string
                              format: date-time
                              example: "2024-01-15T10:30:00.000Z"
                      performance:
                        type: object
                        properties:
                          averageResponseTime:
                            type: string
                            description: "Temps de r√©ponse moyen"
                            example: "2.5ms"
                          totalRequests:
                            type: integer
                            description: "Nombre total de requ√™tes"
                            example: 50000
                          cacheHits:
                            type: integer
                            description: "Nombre de hits"
                            example: 43750
                          cacheMisses:
                            type: integer
                            description: "Nombre de misses"
                            example: 6250
                      uptime:
                        type: string
                        description: "Temps de fonctionnement"
                        example: "2d 14h 30m"
        401:
          description: "Non authentifi√©"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /cache/clear:
    post:
      tags:
        - Cache
      summary: "üóëÔ∏è Vider le cache"
      description: "Vider compl√®tement le cache (r√©serv√© aux administrateurs)"
      security:
        - bearerAuth: []
      responses:
        200:
          description: "Cache vid√© avec succ√®s"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Cache vid√© avec succ√®s"
                  data:
                    type: object
                    properties:
                      keysDeleted:
                        type: integer
                        description: "Nombre de cl√©s supprim√©es"
                        example: 1250
                      memoryFreed:
                        type: string
                        description: "M√©moire lib√©r√©e"
                        example: "45.2 MB"
                      timestamp:
                        type: string
                        format: date-time
                        example: "2024-01-15T10:30:00.000Z"
        401:
          description: "Non autoris√©"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /cache/keys:
    get:
      tags:
        - Cache
      summary: "üîë Liste des cl√©s en cache"
      description: "R√©cup√©rer la liste de toutes les cl√©s en cache (r√©serv√© aux administrateurs)"
      security:
        - bearerAuth: []
      parameters:
        - name: pattern
          in: query
          schema:
            type: string
          description: "Filtrer les cl√©s par pattern"
          example: "user:*"
        - name: limit
          in: query
          schema:
            type: integer
            default: 100
          description: "Nombre maximum de cl√©s √† retourner"
          example: 100
      responses:
        200:
          description: "Liste des cl√©s r√©cup√©r√©e avec succ√®s"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      keys:
                        type: array
                        items:
                          type: object
                          properties:
                            key:
                              type: string
                              example: "user:12345"
                            ttl:
                              type: integer
                              description: "Time to live en secondes"
                              example: 300
                            size:
                              type: string
                              description: "Taille de la valeur"
                              example: "1.2 KB"
                            lastAccessed:
                              type: string
                              format: date-time
                              example: "2024-01-15T10:30:00.000Z"
                      total:
                        type: integer
                        description: "Nombre total de cl√©s"
                        example: 1250
                      filtered:
                        type: integer
                        description: "Nombre de cl√©s apr√®s filtrage"
                        example: 150
        401:
          description: "Non autoris√©"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /cache/keys/{key}:
    get:
      tags:
        - Cache
      summary: "üîç Informations sur une cl√©"
      description: "R√©cup√©rer les informations d√©taill√©es sur une cl√© sp√©cifique"
      security:
        - bearerAuth: []
      parameters:
        - name: key
          in: path
          required: true
          schema:
            type: string
          description: "Cl√© √† examiner"
          example: "user:12345"
      responses:
        200:
          description: "Informations sur la cl√© r√©cup√©r√©es avec succ√®s"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      key:
                        type: string
                        example: "user:12345"
                      exists:
                        type: boolean
                        example: true
                      ttl:
                        type: integer
                        description: "Time to live en secondes"
                        example: 300
                      size:
                        type: string
                        description: "Taille de la valeur"
                        example: "1.2 KB"
                      type:
                        type: string
                        description: "Type de la valeur"
                        example: "object"
                      lastAccessed:
                        type: string
                        format: date-time
                        example: "2024-01-15T10:30:00.000Z"
                      createdAt:
                        type: string
                        format: date-time
                        example: "2024-01-15T10:25:00.000Z"
                      hitCount:
                        type: integer
                        description: "Nombre de fois o√π cette cl√© a √©t√© acc√©d√©e"
                        example: 25
        404:
          description: "Cl√© non trouv√©e"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    delete:
      tags:
        - Cache
      summary: "üóëÔ∏è Supprimer une cl√©"
      description: "Supprimer une cl√© sp√©cifique du cache"
      security:
        - bearerAuth: []
      parameters:
        - name: key
          in: path
          required: true
          schema:
            type: string
          description: "Cl√© √† supprimer"
          example: "user:12345"
      responses:
        200:
          description: "Cl√© supprim√©e avec succ√®s"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Cl√© supprim√©e avec succ√®s"
                  data:
                    type: object
                    properties:
                      key:
                        type: string
                        example: "user:12345"
                      deleted:
                        type: boolean
                        example: true
                      timestamp:
                        type: string
                        format: date-time
                        example: "2024-01-15T10:30:00.000Z"
        404:
          description: "Cl√© non trouv√©e"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /cache/performance:
    get:
      tags:
        - Cache
      summary: "‚ö° Performance du cache"
      description: "R√©cup√©rer les m√©triques de performance du cache"
      security:
        - bearerAuth: []
      responses:
        200:
          description: "M√©triques de performance r√©cup√©r√©es avec succ√®s"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      responseTime:
                        type: object
                        properties:
                          average:
                            type: string
                            example: "2.5ms"
                          min:
                            type: string
                            example: "0.8ms"
                          max:
                            type: string
                            example: "15.2ms"
                          p95:
                            type: string
                            example: "4.1ms"
                          p99:
                            type: string
                            example: "8.7ms"
                      throughput:
                        type: object
                        properties:
                          requestsPerSecond:
                            type: number
                            example: 1250.5
                          peakRequestsPerSecond:
                            type: number
                            example: 2500.0
                          averageRequestsPerMinute:
                            type: number
                            example: 75000.0
                      efficiency:
                        type: object
                        properties:
                          hitRate:
                            type: number
                            example: 87.5
                          missRate:
                            type: number
                            example: 12.5
                          evictionRate:
                            type: number
                            example: 2.1
                      memory:
                        type: object
                        properties:
                          used:
                            type: string
                            example: "45.2 MB"
                          available:
                            type: string
                            example: "82.8 MB"
                          utilization:
                            type: number
                            example: 35.3
                      trends:
                        type: object
                        properties:
                          hitRateTrend:
                            type: string
                            enum: [increasing, stable, decreasing]
                            example: "stable"
                          memoryTrend:
                            type: string
                            enum: [increasing, stable, decreasing]
                            example: "increasing"
                          performanceTrend:
                            type: string
                            enum: [improving, stable, degrading]
                            example: "stable"

components:
  schemas:
    CacheStats:
      type: object
      properties:
        cacheType:
          type: string
          description: "Type de cache utilis√©"
          example: "simple"
        totalKeys:
          type: integer
          description: "Nombre total de cl√©s en cache"
          example: 1250
        memoryUsage:
          type: object
          properties:
            used:
              type: string
              description: "M√©moire utilis√©e"
              example: "45.2 MB"
            total:
              type: string
              description: "M√©moire totale"
              example: "128.0 MB"
            percentage:
              type: number
              description: "Pourcentage d'utilisation"
              example: 35.3
        hitRate:
          type: number
          description: "Taux de r√©ussite du cache (0-100)"
          example: 87.5
        missRate:
          type: number
          description: "Taux d'√©chec du cache (0-100)"
          example: 12.5
        uptime:
          type: string
          description: "Temps de fonctionnement"
          example: "2d 14h 30m"

    CacheKey:
      type: object
      properties:
        key:
          type: string
          description: "Cl√© du cache"
          example: "user:12345"
        ttl:
          type: integer
          description: "Time to live en secondes"
          example: 300
        size:
          type: string
          description: "Taille de la valeur"
          example: "1.2 KB"
        lastAccessed:
          type: string
          format: date-time
          description: "Derni√®re fois que la cl√© a √©t√© acc√©d√©e"
          example: "2024-01-15T10:30:00.000Z"
        hitCount:
          type: integer
          description: "Nombre de fois o√π cette cl√© a √©t√© acc√©d√©e"
          example: 25

    CachePerformance:
      type: object
      properties:
        responseTime:
          type: object
          properties:
            average:
              type: string
              example: "2.5ms"
            min:
              type: string
              example: "0.8ms"
            max:
              type: string
              example: "15.2ms"
            p95:
              type: string
              example: "4.1ms"
            p99:
              type: string
              example: "8.7ms"
        throughput:
          type: object
          properties:
            requestsPerSecond:
              type: number
              example: 1250.5
            peakRequestsPerSecond:
              type: number
              example: 2500.0
            averageRequestsPerMinute:
              type: number
              example: 75000.0
        efficiency:
          type: object
          properties:
            hitRate:
              type: number
              example: 87.5
            missRate:
              type: number
              example: 12.5
            evictionRate:
              type: number
              example: 2.1
